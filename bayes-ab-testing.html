<!DOCTYPE html>
<html lang="en"><head>
<script src="bayes-ab-testing_files/libs/clipboard/clipboard.min.js"></script>
<script src="bayes-ab-testing_files/libs/quarto-html/tabby.min.js"></script>
<script src="bayes-ab-testing_files/libs/quarto-html/popper.min.js"></script>
<script src="bayes-ab-testing_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="bayes-ab-testing_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="bayes-ab-testing_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="bayes-ab-testing_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.36">

  <meta name="author" content="Johann de Boer">
  <title>Introduction to Bayesian A/B testing</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="bayes-ab-testing_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="bayes-ab-testing_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="bayes-ab-testing_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="bayes-ab-testing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="bayes-ab-testing_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="bayes-ab-testing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="bayes-ab-testing_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Introduction to Bayesian A/B testing</h1>
  <p class="author">Johann de Boer</p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Agenda</h2>
<ul>
<li><a href="#/setting-the-scene" id="/toc-setting-the-scene">Setting the scene</a></li>
<li><a href="#/priors-and-probability-distributions" id="/toc-priors-and-probability-distributions">Priors and probability distributions</a></li>
<li><a href="#/running-a-bayesian-ab-test" id="/toc-running-a-bayesian-ab-test">Running a Bayesian A/B test</a></li>
<li><a href="#/posterior-analysis" id="/toc-posterior-analysis">Posterior analysis</a></li>
<li><a href="#/when-to-stop-a-bayesian-ab-test" id="/toc-when-to-stop-a-bayesian-ab-test">When to stop a Bayesian A/B test?</a></li>
<li><a href="#/summary-and-some-final-remarks" id="/toc-summary-and-some-final-remarks">Summary and some final remarks</a></li>
<li><a href="#/questions" id="/toc-questions">Questions?</a></li>
</ul>
</nav>
</section>

<section>
<section id="setting-the-scene" class="title-slide slide level1 center">
<h1>Setting the scene</h1>

</section>
<section id="randomised-control-trials-rcts" class="slide level2 smaller">
<h2>Randomised Control Trials (RCTs)</h2>
<p>A simplistic example:</p>
<ul>
<li><p>Users are assigned at <strong>random</strong> to two groups, A and B, with equal probability.</p></li>
<li><p>Let A be our <strong>control</strong> group and B be our <strong>treatment</strong> group.</p></li>
</ul>
<p>We want to know what effect our treatment has.</p>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Early on during an experiment, differences between these groups could simply be due to the random allocation of participants. As the groups get larger, these random differences will diminish, bringing us closer to the difference caused by the treatment.</p>
<p>Applying Bayesian inference effectively gives the experiment a guided head start by including more data in the form of <strong>priors</strong>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="hypothetical-scenario" class="slide level2">
<h2>Hypothetical scenario</h2>
<div class="columns">
<div class="column" style="width:70%;">
<p>We have a button on a landing page that takes users to a sign up form.</p>
<p>At present, the button is labelled “Register your interest”.</p>
<p>We want to test whether changing it to “Get started” will result in an increased click-through rate (CTR).</p>
<p>The idea of “Get started” was suggested by an experienced and skilled UX design professional.</p>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="A_B%20Button%20CTA%20test.png" alt="Two button CTA being compared: &quot;Register your interest&quot; vs &quot;Get started&quot;"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="priors-and-probability-distributions" class="title-slide slide level1 center">
<h1>Priors and probability distributions</h1>

</section>
<section id="prior-knowledge-and-beliefs" class="slide level2 smaller">
<h2>Prior knowledge and beliefs</h2>
<p>Before running an experiment, we form opinions about what we expect to see. We gather evidence such as:</p>
<ul>
<li><p>The baseline click-through rate of the button (with its current label) and knowledge of any outside variables that affects click-through rate, e.g.&nbsp;seasonality</p></li>
<li><p>Effects we have seen from similar previous experiments</p></li>
<li><p>Qualitative research, such as usability tests, focus groups, and surveys that are related to the test</p></li>
<li><p>Opinions (including critical views) from interested parties, including experts</p></li>
</ul>
</section>
<section id="priors-are-probability-distributions" class="slide level2 smaller">
<h2>Priors are probability distributions</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p>We express our prior beliefs about the control group using a <strong>probability distribution</strong>.</p>
<p>This plot shows an example of an extremely uninformative prior – a uniform prior that says every outcome is equally likely, i.e.&nbsp;naive.</p>
</div><div class="column" style="width:70%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <strong>Beta distribution</strong> is a <strong>probability density function (PDF)</strong> with two <strong>shape parameters</strong>: <span class="math inline">\(B(shape1, shape2)\)</span>. It’s used to describe proportions, such as click-through rate.</p>
</div>
</div>
</div>
<aside class="notes">
<p>The total area under the curve will always add to 100%. That is, the curve represents all possibilities regardless of what shape parameters are used.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="something-a-little-more-informative" class="slide level2 smaller">
<h2>Something a little more informative</h2>

<img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"><p>As the curve narrows, notice that the shape parameters of the Beta distribution increase.</p>
</section>
<section id="something-even-more-informative" class="slide level2 smaller">
<h2>Something even more informative</h2>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-4-1.png" width="1056"></p>
</div>
</div>
<div class="columns">
<div class="column" style="width:75%;">
<p>The shape parameters (<code>shape1</code> and <code>shape2</code>) of the Beta distribution can be considered counts of <strong>successes</strong> and <strong>failures</strong>, respectively. Therefore, the mean probability of success (i.e.&nbsp;average click-through rate) can be calculated by this formula:</p>
</div><div class="column" style="width:25%;">
<p><span class="math display">\[
\frac{shape1}{shape1 + shape2}
\]</span></p>
</div>
</div>
<aside class="notes">
<p>The shape parameters are actually slightly more than the count of successes and failures, i.e.&nbsp;<span class="math inline">\(successes = \alpha - 1\)</span> and <span class="math inline">\(failures = \beta - 1\)</span>, or <span class="math inline">\(successes = \alpha - 0.5\)</span> and <span class="math inline">\(failures = \beta - 0.5\)</span> if using Jeffreys prior.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lets-say-weve-settled-on-this" class="slide level2 smaller">
<h2>Let’s say we’ve settled on this:</h2>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</div>
</div>
<p>The more confident we are about our beliefs, the narrower the curve.</p>
<aside class="notes">
<p>The mean of this curve is: <span class="math inline">\(\mu = \frac{\alpha}{\alpha + \beta}\)</span></p>
<p>The standard deviation of this curve is: <span class="math inline">\(\sigma = \sqrt{\frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}}\)</span></p>
<p>Where <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> represent the first and second shape parameters of the Beta distribution, respectively.</p>
<p>Through substitution and rearrangement, you can determine <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> from <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="what-about-the-treatment-group" class="slide level2 smaller">
<h2>What about the treatment group?</h2>
<ul>
<li><p>We expect that the click-through rates of the treatment and control groups will be correlated.</p></li>
<li><p>We don’t know how correlated they will be, but we’re not expecting a dramatic difference between them.</p></li>
<li><p>We hope that the click-through rate of the treatment group will be an improvement, but we’re open to other possibilities.</p></li>
<li><p>We’re more confident than not that the click-through rate of the treatment group will be an improvement over control.</p></li>
<li><p>We don’t want to bias the results of the experiment in favour of treatment or control, or towards a conclusion of there being a difference or no difference.</p></li>
</ul>
</section>
<section id="weve-settled-on-these-priors" class="slide level2">
<h2>We’ve settled on these priors:</h2>

<img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="running-a-bayesian-ab-test" class="title-slide slide level1 center">
<h1>Running a Bayesian A/B test</h1>

</section>
<section id="prior-agreement" class="slide level2 smaller">
<h2>Prior agreement</h2>
<p>Agreement must be reached on the priors before collecting and analysing data from the experiment.</p>
<p>Once we’ve agreed on the priors and have locked them in, we can start the experiment.</p>
<p>Here’s a summary of the priors we have chosen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>priors <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-3"><a href="#cb1-3"></a>        <span class="at">mean =</span> (shape1 <span class="sc">/</span> (shape1 <span class="sc">+</span> shape2)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4"></a>            scales<span class="sc">::</span><span class="fu">percent</span>(),</span>
<span id="cb1-5"><a href="#cb1-5"></a>        <span class="at">sd =</span> <span class="fu">sqrt</span>(</span>
<span id="cb1-6"><a href="#cb1-6"></a>            shape1 <span class="sc">*</span> shape2 <span class="sc">/</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>                ((shape1 <span class="sc">+</span> shape2) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (shape1 <span class="sc">+</span> shape2 <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb1-8"><a href="#cb1-8"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>            scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">suffix =</span> <span class="st">" p.p."</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">group</th>
<th style="text-align: right;">shape1</th>
<th style="text-align: right;">shape2</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">288</td>
<td style="text-align: left;">29.4%</td>
<td style="text-align: left;">2.3 p.p.</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">31.0%</td>
<td style="text-align: left;">4.9 p.p.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<aside class="notes">
<p>It’s important to not change your original priors after seeing data collected from the experiment. Doing so is effectively double-dipping, whereby your priors are being influenced by the data you have collected.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lets-run-a-simulated-experiment" class="slide level2">
<h2>Let’s run a simulated experiment</h2>
<div class="cell">

</div>
<p>Let’s pretend that there’s some true theoretical click-through rate for the control and treatment groups, 32% and 35% respectively. That equates to a relative uplift of 9.4%.</p>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Remember that this is just a hypothetical simulation. We wouldn’t know these in a real experiment ¯\_(ツ)_/¯.</p>
</div>
</div>
</div>
<p>If we’re successful at applying Bayesian inference then we should hope to see (but can’t guarantee due to randomness) results that somewhat match with these theoretical CTRs.</p>
</section>
<section id="day-since-the-experiment-started" class="slide level2">
<h2>1 day since the experiment started…</h2>
<div class="cell">

</div>
<p>Let’s pretend that on average 150 users enter our experiment each day, and we’ve received the following data from day 1:</p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">group</th>
<th style="text-align: right;">total_users</th>
<th style="text-align: right;">clicked</th>
<th style="text-align: right;">not_clicked</th>
<th style="text-align: left;">CTR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">control</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">27.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;">treatment</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">65</td>
<td style="text-align: left;">33.0%</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<aside class="notes">
<p>Our experiment simulator randomly selects users and assigns them to each group using a Poisson process. It then randomly chooses which users had clicked using Bernoulli trials (e.g.&nbsp;coin flips).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lets-now-incorporate-our-priors" class="slide level2 smaller">
<h2>Let’s now incorporate our priors</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>For each experiment group, we derive our <strong>posterior</strong> shape parameters through simple arithmetic addition:</p>
<div class="fragment" data-fragment-index="1">
<ul>
<li>Increment the first shape parameter by the count users who had <strong>clicked</strong></li>
</ul>
</div>
<div class="fragment" data-fragment-index="2">
<ul>
<li>Increment the second shape parameter by the count users who <strong>didn’t click</strong></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">

</div>
<div class="fragment" data-fragment-index="1">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">count</th>
<th style="text-align: right;">control</th>
<th style="text-align: right;">treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">prior_shape1</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">clicked</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">posterior_shape1</td>
<td style="text-align: right;">137</td>
<td style="text-align: right;">59</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="fragment" data-fragment-index="2">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th style="text-align: left;">count</th>
<th style="text-align: right;">control</th>
<th style="text-align: right;">treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">prior_shape2</td>
<td style="text-align: right;">288</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">not_clicked</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">posterior_shape2</td>
<td style="text-align: right;">333</td>
<td style="text-align: right;">125</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>The process of incorporating data with priors is called Bayesian updating. The data generated follows a Bernoulli distribution (Binomial with 1 trial). The prior follows a Beta distribution, which is conjugate to the Binomial distribution.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="posterior-distribution-of-each-group" class="slide level2">
<h2>Posterior distribution of each group</h2>

<img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"><p>We have now updated our beliefs. These posteriors can now be thought of as our updated priors.</p>
</section>
<section id="another-six-days-later" class="slide level2">
<h2>Another six days later…</h2>
<p>We’ve now collected more data, so let’s update our priors to form new posteriors.</p>
<div class="cell">

</div>

<img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="another-three-weeks-later" class="slide level2">
<h2>Another three weeks later…</h2>
<p>We’ve now collected even more data, so let’s again update our priors to form new posteriors.</p>
<div class="cell">

</div>

<img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="posterior-analysis" class="title-slide slide level1 center">
<h1>Posterior analysis</h1>
<p>Statistical inferences using the posterior distributions</p>
</section>
<section id="monte-carlo-simulation" class="slide level2 smaller">
<h2>Monte Carlo simulation</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>We can draw a very very large number of random samples from our posterior distributions to make inferences about the experiment.</p>
<p>This is called Monte Carlo simulation – named after a well known casino.</p>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The more samples drawn, the greater the reliability and precision of the inferences you make, but this comes at the cost of computational time and memory. Nowadays, computer processing speed and memory are more than adequate for what we need.</p>
</div>
</div>
</div>
</div><div class="column" style="width:35%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="https://creativecommons.org/licenses/by/2.0"><img data-src="Real_Monte_Carlo_Casino.jpg" alt="Monte Carlo Casino, Monaco, France"></a></p>
<p></p><figcaption>Credits: Sam Garza from Los Angeles, USA, CC BY 2.0, via Wikimedia Commons</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="simulations" class="slide level2 smaller">
<h2>100 simulations</h2>
<p>Let’s start slowly by drawing 100 random samples from our distributions and plotting them using histograms…</p>
<div class="columns">
<div class="column" style="width:55%;">
<div class="cell">

</div>
<div class="fragment fade-up">
<p>Here’s some of our Monte Carlo samples:</p>
<div class="cell">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">control</th>
<th style="text-align: right;">treatment</th>
<th style="text-align: right;">uplift</th>
<th style="text-align: left;">beats_control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.294</td>
<td style="text-align: right;">0.341</td>
<td style="text-align: right;">0.161</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">0.344</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">0.368</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.347</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.299</td>
<td style="text-align: right;">0.377</td>
<td style="text-align: right;">0.260</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.350</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.297</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div class="column" style="width:45%;">
<div class="fragment">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-22-1.gif"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="lets-now-beef-it-up-a-bit" class="slide level2">
<h2>Let’s now beef it up a bit…</h2>
<div class="cell">

</div>
<p>We’ll now draw 1 000 000 samples…</p>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-24-1.gif"></p>
</div>
</div>
</div>
<aside class="notes">
<p>Notice how these histograms follow the same distribution as our posteriors. That is because these samples have been drawn at random according to those posterior distributions.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="we-can-now-make-some-inferences" class="slide level2">
<h2>We can now make some inferences</h2>
<p>Here’s a summary of our posterior predictive distributions as a result of the 1 000 000 simulations:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    control         treatment          uplift         beats_control  
 Min.   :0.2550   Min.   :0.3031   Min.   :-0.03964   Mode :logical  
 1st Qu.:0.2905   1st Qu.:0.3443   1st Qu.: 0.15030   FALSE:30       
 Median :0.2966   Median :0.3511   Median : 0.18340   TRUE :999970   
 Mean   :0.2967   Mean   :0.3511   Mean   : 0.18455                  
 3rd Qu.:0.3028   3rd Qu.:0.3579   3rd Qu.: 0.21760                  
 Max.   :0.3392   Max.   :0.3970   Max.   : 0.46371                  </code></pre>
</div>
</div>
<p>What is the probability that the CTR of the treatment is greater than that of control?</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">with</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>    posterior_comparison,</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="fu">mean</span>(beats_control)</span>
<span id="cb3-4"><a href="#cb3-4"></a>) <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "100.00%"</code></pre>
</div>
</div>
</div>
<aside class="notes">
<p>Out of our 1 000 000 simulations, we can see how often the treatment bet control. This tells us the probability that treatment is the winner.</p>
<p>If we filtered our simulations to those where control won and calculated the median CTR uplift, and did the same for cases where treatment won, we can determine the expected losses of choosing either variant as the winner. We should prefer the variant with the lowest expected loss or continue to run the experiment longer to improve our confidence.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="posterior-distribution-of-the-ctr-uplift" class="slide level2">
<h2>Posterior distribution of the CTR uplift</h2>

<img data-src="bayes-ab-testing_files/figure-revealjs/unnamed-chunk-27-1.gif" class="r-stretch"></section></section>
<section>
<section id="when-to-stop-a-bayesian-ab-test" class="title-slide slide level1 center">
<h1>When to stop a Bayesian A/B test?</h1>

</section>
<section id="if-using-uninformative-priors" class="slide level2">
<h2>If using uninformative priors…</h2>
<p>If your original priors are uninformative or too weak, then you face the same risks as with frequentist experiments.</p>
<p>Perform <strong>power analysis</strong> ahead of running the experiment. This is to determine the required sample size before any inferences are made.</p>
<p>Prior to the experiment commencing, decide on:</p>
<ul>
<li><p>The <strong>minimum detectable effect</strong> size</p></li>
<li><p>The accepted <strong>false positive rate</strong></p></li>
<li><p>The accepted <strong>false negative rate</strong></p></li>
</ul>
</section>
<section id="if-using-informative-priors" class="slide level2">
<h2>If using informative priors…</h2>
<p>If your priors are relatively informative and chosen carefully, then this can reduce the chances of false positives and negatives. But:</p>
<ul>
<li><p>Be careful to not bias the results of the experiment.</p></li>
<li><p>Power analysis is still recommended in order to gauge the worse case scenario for how long the experiment might run.</p></li>
</ul>
<p>Bayesian inference, with informative priors, can make it possible to end an experiment early.</p>
</section>
<section id="if-deciding-to-end-early" class="slide level2">
<h2>If deciding to end early…</h2>
<p>Ask yourself:</p>
<ul>
<li><p>Has the experiment run for at least a couple of cycles? (e.g.&nbsp;at least two full weeks)</p></li>
<li><p>Have the results stabilised? Is there a clear winner?</p></li>
<li><p>Could it be worth running longer to learn more?</p></li>
<li><p>What are the risks of continuing or ending now? What if the results you see are just a fluke and are therefore misguiding you? What is the impact of making the wrong choice? What are the chances?</p></li>
</ul>
</section></section>
<section>
<section id="summary-and-some-final-remarks" class="title-slide slide level1 center">
<h1>Summary and some final remarks</h1>

</section>
<section id="before-starting-an-experiment" class="slide level2 smaller">
<h2>Before starting an experiment</h2>
<p>Gather prior knowledge and articulate beliefs:</p>
<ul>
<li><p>Establish a baseline - what do you know about the control group?</p></li>
<li><p>What do you expect the effect of the treatment to be? How sure are you?</p></li>
</ul>
<p>Express those beliefs and knowledge as distributions - these are your priors for your control and treatment groups.</p>
<div class="callout callout-important callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Ensure that the priors encapsulate the collective knowledge and beliefs of all interested parties so that there is agreement. This helps to avoid the results from being challenged later. This is because everyone would have already had an opportunity to provide their opinions.</p>
</div>
</div>
</div>
</section>
<section id="running-the-experiment" class="slide level2">
<h2>Running the experiment</h2>
<ul>
<li><p>Start the experiment, gather data, and update your priors to form posteriors</p></li>
<li><p>Draw inferences by running a large number of Monte Carlo simulations using the posteriors</p></li>
<li><p>Know when to end the experiment – try to plan for this ahead of running the experiment</p></li>
</ul>
</section>
<section id="final-remarks" class="slide level2 smaller">
<h2>Final remarks</h2>
<p>Null-hypothesis significance testing (NHST) is not what Bayesian is for:</p>
<ul>
<li><p>Bayesian tells you the probability of some effect being within some range, given the data. I.e. Given everything we know so far, what are the risks associated with the choices we have?</p></li>
<li><p>NHST tells you the probability of data at least as extreme as what has been observed, given there is no real effect. I.e. How ridiculous would this outcome be if it were due to chance alone?</p></li>
</ul>
<p>NHST is often referred to as the frequentist approach, where decisions are made using p-values and some arbitrary threshold <span class="math inline">\(\alpha\)</span> (i.e.&nbsp;false positive rate).</p>
<p>Unlike NHST, Bayesian A/B testing doesn’t give you a yes/no answer – it instead informs you about the probabilities and risks associated with the choices you have.</p>
</section></section>
<section id="questions" class="title-slide slide level1 center">
<h1>Questions?</h1>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>These presentation slides and simulations have been produced in RStudio using Quarto. You can download the source code and slides from Github at: <a href="https://github.com/jdeboer/measurecamp2022" class="uri">https://github.com/jdeboer/measurecamp2022</a></p>
</div>
</div>
</div>

<img src="Logo_MeasureCamp_SYD_2015-3.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Johann de Boer - Sydney Measurecamp 2022</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="bayes-ab-testing_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="bayes-ab-testing_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="bayes-ab-testing_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>